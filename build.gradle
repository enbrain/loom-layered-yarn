plugins {
    id "java-gradle-plugin"
    id "maven-publish"
}

group = "io.github.enbrain"
version = "0.9.4"

sourceCompatibility = JavaVersion.VERSION_17
targetCompatibility = JavaVersion.VERSION_17

repositories {
    mavenCentral()
    maven {
        url = "https://maven.fabricmc.net"
    }
    mavenLocal()
}

dependencies {
    compileOnly "net.fabricmc:fabric-loom:0.11.29"
    implementation "net.fabricmc:mapping-io:0.2.1"

    implementation "com.google.code.gson:gson:2.8.9"
    compileOnly "org.jetbrains:annotations:23.0.0"
}

gradlePlugin {
    plugins {
        create("loom-layered-yarn") {
            id = "io.github.enbrain.loom-layered-yarn"
            implementationClass = "io.github.enbrain.loomlayeredyarn.LoomLayeredYarnPlugin"
        }
    }
}

publishing {
    repositories {
        mavenLocal()
        if (System.getenv("MAVEN_URL") != null) {
            maven {
                setUrl(System.getenv("MAVEN_URL"))
                credentials {
                    username = System.getenv("MAVEN_USERNAME")
                    password = System.getenv("MAVEN_PASSWORD")
                }
                name = "Maven"
            }
        }
    }
}
